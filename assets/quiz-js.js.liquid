$(document).ready(function(){
	
  var selection = [];
  
  var options_combination = [];
  
  var variant, product;
  
  $('.single-selection').click(function(e) {
    $(this).closest('.optionBox').find('.single-selection').removeClass('active');
    $(this).addClass('active');
    
    var name = $(this).find('input').data('result');

    if(name != undefined){
      if(name == 'question_3' || name == 'question_4' || name == 'question_5'){
        if(name == 'question_3'){
          options_combination[0] = $(this).find('input').data('option');
        }
        if(name == 'question_4'){
          options_combination[1] = $(this).find('input').data('option');
        } 
        if(name == 'question_5'){
          options_combination[2] = $(this).find('input').data('option');
          
          console.log(options_combination);
          if(options_combination[0] == 1){
            if(options_combination[1] == 1 && options_combination[2] == 'question_5_darker' ){variant = 'Light'; product = 'fiera-luxury-concealer-light';}
            else if(options_combination[1] == 1){variant = 'Light'; product = 'fiera-luxury-concealer-light';}
            if(options_combination[1] == 2 && options_combination[2] == 'question_5_darker'){variant = 'Medium'; product = 'fiera-luxury-concealer-medium';}
            else if(options_combination[1] == 2 && options_combination[2] == 'question_5_lighter'){variant = 'Neutral Beige'; product = 'fiera-luxury-concealer-neutral-beige';}
            else if(options_combination[1] == 2){variant = 'Neutral Beige'; product = 'fiera-luxury-concealer-neutral-beige';}
            if(options_combination[1] == 3 && options_combination[2] == 'question_5_lighter' ){variant = 'Light'; product = 'fiera-luxury-concealer-light';}
            else if(options_combination[1] == 3 && options_combination[2] == 'question_5_darker' ){variant = 'Deep'; product = 'fiera-luxury-concealer-deep';}
            else if(options_combination[1] == 3){variant = 'Medium'; product = 'fiera-luxury-concealer-medium';}
            if(options_combination[1] == 4 && options_combination[2] == 'question_5_lighter' ){variant = 'Medium'; product = 'fiera-luxury-concealer-medium';}
            else if(options_combination[1] == 4 && options_combination[2] == 'question_5_darker' ){variant = 'Dark'; product = 'fiera-luxury-concealer-dark';}
            else if(options_combination[1] == 4){variant = 'Deep'; product = 'fiera-luxury-concealer-deep';}
            if(options_combination[1] == 5){variant = 'Dark'; product = 'fiera-luxury-concealer-dark';}
          }

          if(options_combination[0] == 2){
            if(options_combination[1] == 1 && options_combination[2] == 'question_5_darker' ){variant = 'Light'; product = 'fiera-luxury-concealer-light';}
            else if(options_combination[1] == 1){variant = 'Light'; product = 'fiera-luxury-concealer-light';}
            if(options_combination[1] == 2 && options_combination[2] == 'question_5_darker'){variant = 'Medium'; product = 'fiera-luxury-concealer-medium';}
            else if(options_combination[1] == 2 && options_combination[2] == 'question_5_lighter'){variant = 'Neutral Beige'; product = 'fiera-luxury-concealer-neutral-beige';}
            else if(options_combination[1] == 2){variant = 'Light'; product = 'fiera-luxury-concealer-light';}
            if(options_combination[1] == 3 && options_combination[2] == 'question_5_lighter' ){variant = 'Light'; product = 'fiera-luxury-concealer-light';}
            else if(options_combination[1] == 3 && options_combination[2] == 'question_5_darker' ){variant = 'Deep'; product = 'fiera-luxury-concealer-deep';}
            else if(options_combination[1] == 3){variant = 'Neutral Beige'; product = 'fiera-luxury-concealer-neutral-beige';}
            if(options_combination[1] == 4 && options_combination[2] == 'question_5_lighter' ){variant = 'Medium'; product = 'fiera-luxury-concealer-medium';}
            else if(options_combination[1] == 4 && options_combination[2] == 'question_5_darker' ){variant = 'Dark'; product = 'fiera-luxury-concealer-dark';}
            else if(options_combination[1] == 4){variant = 'Medium'; product = 'fiera-luxury-concealer-medium';}
            if(options_combination[1] == 5){variant = 'Deep'; product = 'fiera-luxury-concealer-deep';}
          }

          if($(this).hasClass('active')){
            $(this).find('.option_select_radio').attr('checked', 'checked');
          }
        }
      }
      
      if(name == 'question_8'){
        if($(this).hasClass('active')){
          $(this).find('.option_select_radio').attr('checked', 'checked');
        }
       }
        
       if(name == 'question_5'){
         if($(this).hasClass('active')){
           $(this).find('.option_select_radio').attr('checked', 'checked');
         }
       }
      $('.quiz_result_variant').val(variant);
     
      var result = {shade:variant, product:product};
      
      if(product != undefined){
        setCookie('quiz-result',JSON.stringify(result),'1');
      }
    }
    
    ///selection[name] = $(this).find('input').attr('value');
    
    if ( $(this).hasClass('tone-selection')){
      $(this).closest('.question-Box').next('.question-Box').find('.tones-list').hide();
      var imgName = $(this).attr('data-name');
     // console.log(imgName);
      $(this).closest('.question-Box').next('.question-Box').find('#' + imgName).show();

      if ( imgName == 'fair'){
        $('.colorlight').hide();
        $('.colordark').show();
        $('.colordark').addClass('margin-top');
      } else if ( imgName == 'dark' ){
        $('.colorlight').show();
        $('.colordark').hide();
        $('.colordark').removeClass('margin-top');
      } else{
        $('.colorlight').show();
        $('.colordark').show();
        $('.colordark').removeClass('margin-top');
      }
    }
  });

  $('.multi-selection').click(function(e) {
    
    //var name = $(this).find('input').attr('name');

    //selection[name] = $(this).find('input').attr('value');
    
    if ( $(this).hasClass('active')){
      $(this).removeClass('active');
    }else{
      $(this).addClass('active');		
    }
  });
  
   $('.comn-btn1').click(function(e) {
     
     if ($('.step-4 .optionBox').find('.fair').hasClass('active')){
       if ($(this).closest('.step-5 .optionBox').find('.colordark').hasClass('active')){
         $(this).closest('.step-5 .optionBox').find('#light').show();
         $(this).closest('.step-5 .optionBox').find('#dark').hide();
         $(this).closest('.step-5 .optionBox').find('#medium').hide();
         $(this).closest('.step-5 .optionBox').find('#tan').hide();
         $(this).closest('.step-5 .optionBox').find('#fair').hide();
         $('.colorlight').hide();
         $('.colordark').hide();
       }
       else{
        $(this).closest('.question-Box').hide();
        $(this).closest('.question-Box').next('.question-Box').fadeIn();
        progress();
       
       }
     
     }
     
     if ($('.step-4 .optionBox').find('.light').hasClass('active')){
       if ($(this).closest('.step-5 .optionBox').find('.colorlight').hasClass('active')){
         $(this).closest('.step-5 .optionBox').find('#fair').show();
         $(this).closest('.step-5 .optionBox').find('#medium').hide();
         $(this).closest('.step-5 .optionBox').find('#light').hide();
         $(this).closest('.step-5 .optionBox').find('#dark').hide();
         $(this).closest('.step-5 .optionBox').find('#tan').hide();
         $('.colorlight').hide();
         $('.colordark').hide();
       }
       else if ($(this).closest('.step-5 .optionBox').find('.colordark').hasClass('active')){
         $(this).closest('.step-5 .optionBox').find('#medium').show();
         $(this).closest('.step-5 .optionBox').find('#fair').hide();
         $(this).closest('.step-5 .optionBox').find('#light').hide();
         $(this).closest('.step-5 .optionBox').find('#dark').hide();
         $(this).closest('.step-5 .optionBox').find('#tan').hide();
         $('.colorlight').hide();
         $('.colordark').hide();
       }
       else{
        $(this).closest('.question-Box').hide();
        $(this).closest('.question-Box').next('.question-Box').fadeIn();
        progress();
       
       }
     }
     if ($('.step-4 .optionBox').find('.medium').hasClass('active')){
       if ($(this).closest('.step-5 .optionBox').find('.colorlight').hasClass('active')){
         $(this).closest('.step-5 .optionBox').find('#light').show();
         $(this).closest('.step-5 .optionBox').find('#dark').hide();
         $(this).closest('.step-5 .optionBox').find('#medium').hide();
         $(this).closest('.step-5 .optionBox').find('#tan').hide();
         $(this).closest('.step-5 .optionBox').find('#fair').hide();
         $('.colorlight').hide();
         $('.colordark').hide();
       }
       else if ($(this).closest('.step-5 .optionBox').find('.colordark').hasClass('active')){
         $(this).closest('.step-5 .optionBox').find('#tan').show();
         $(this).closest('.step-5 .optionBox').find('#dark').hide();
         $(this).closest('.step-5 .optionBox').find('#light').hide();
         $(this).closest('.step-5 .optionBox').find('#medium').hide();
         $(this).closest('.step-5 .optionBox').find('#fair').hide();
         $('.colorlight').hide();
         $('.colordark').hide();
       }
       else{
         $(this).closest('.question-Box').hide();
         $(this).closest('.question-Box').next('.question-Box').fadeIn();
         progress();

       }
     }
     if ($('.step-4 .optionBox').find('.tan').hasClass('active')){
       if ($(this).closest('.step-5 .optionBox').find('.colorlight').hasClass('active')){
         $(this).closest('.step-5 .optionBox').find('#medium').show();
         $(this).closest('.step-5 .optionBox').find('#light').hide();
         $(this).closest('.step-5 .optionBox').find('#dark').hide();
         $(this).closest('.step-5 .optionBox').find('#tan').hide();
         $(this).closest('.step-5 .optionBox').find('#fair').hide();
         $('.colorlight').hide();
         $('.colordark').hide();
       }
       else if ($(this).closest('.step-5 .optionBox').find('.colordark').hasClass('active')){
         $(this).closest('.step-5 .optionBox').find('#dark').show();
         $(this).closest('.step-5 .optionBox').find('#tan').hide();
         $(this).closest('.step-5 .optionBox').find('#light').hide();
         $(this).closest('.step-5 .optionBox').find('#medium').hide();
         $(this).closest('.step-5 .optionBox').find('#fair').hide();
         $('.colorlight').hide();
         $('.colordark').hide();
       }
       else{
         $(this).closest('.question-Box').hide();
         $(this).closest('.question-Box').next('.question-Box').fadeIn();
         progress();

       }
     }
     if ($('.step-4 .optionBox').find('.dark').hasClass('active')){
       if ($(this).closest('.step-5 .optionBox').find('.colorlight').hasClass('active')){
         $(this).closest('.step-5 .optionBox').find('#tan').show();
         $(this).closest('.step-5 .optionBox').find('#light').hide();
         $(this).closest('.step-5 .optionBox').find('#dark').hide();
         $(this).closest('.step-5 .optionBox').find('#medium').hide();
         $(this).closest('.step-5 .optionBox').find('#fair').hide();
         $('.colorlight').hide();
         $('.colordark').hide();
       }
       else{
        $(this).closest('.question-Box').hide();
        $(this).closest('.question-Box').next('.question-Box').fadeIn();
        progress();
       
       }
     }
   });

  $('.comn-btn').click(function(e) {
    $("html, body").animate({ scrollTop: 0 }, "slow");
    if($(this).parents('.colorOption').length > 0){
      var val = $(this).next('input').prop("checked", true);          
    }
    
    
    if ($(this).closest('.step-6 .optionBox').find('.single-selection').hasClass('active')){
      $(this).closest('.question-Box').hide();
      $('.step-7').show();
    
    }
    else if ($(this).hasClass('novalidate')){
      $(this).closest('.question-Box').hide();
      $(this).closest('.question-Box').next('.question-Box').fadeIn();
    }else{
      if ( $(this).closest('.optionBox').find('.single-selection, .multi-selection').hasClass('active')){
        $(this).closest('.question-Box').hide();
        $(this).closest('.question-Box').next('.question-Box').fadeIn();

      }else{
        $(this).closest('.mob-bottom').find('.error-msg').fadeIn();
      }
    }
    
    if ($(this).closest('.step-4 .optionBox').find('.single-selection').hasClass('active')){
      console.log('hii');
      $(this).closest('.question-Box').next('.question-Box').find('.tones-list').hide();
      var imgName = $(this).closest('.step-4 .optionBox').find('.active').attr('data-name');
      console.log(imgName);
      $(this).closest('.question-Box').next('.question-Box').find('#' + imgName).show();

      if ( imgName == 'fair'){
        $('.colorlight').hide();
        $('.colordark').show();
        $('.colordark').addClass('margin-top');
      } else if ( imgName == 'dark' ){
        $('.colorlight').show();
        $('.colordark').hide();
        $('.colordark').removeClass('margin-top');
      } else{
        $('.colorlight').show();
        $('.colordark').show();
        $('.colordark').removeClass('margin-top');
      }
    }
    

    $(this).closest('.question-Box').next('.question-Box').find('.optionbox-row').removeClass('active');		
    progress();
  });

  $('.pop-nextBtn').click(function(e) {
    $(this).closest('.question-Box').hide();
    $('.step-7').fadeIn();
    progress();
  });

  $('.nextSelection').click(function(e) {
    $(this).closest('.question-Box').hide();
    $(this).closest('.question-Box').next('.question-Box').fadeIn();
    progress();
  });


  $('.btn-back').click(function () {
    if($(this).closest('.question-Box').hasClass('step-7')){
      if($(this).parents().find('.step-6').find('.coverage-row').hasClass('active')){
          $('.question-Box.step-6').show();
          $('.question-Box.step-7').hide();
      }
      else{
        $(this).closest('.question-Box').hide();
        $(this).closest('.question-Box').prev('.question-Box').fadeIn();
        $('.error-msg').hide();
        progress();
        $('.pop-body').fadeOut();
        $('.colorlight, .colordark').show();
      }
    }
    else{
    $(this).closest('.question-Box').hide();
    $(this).closest('.question-Box').prev('.question-Box').fadeIn();
    $('.error-msg').hide();
    progress();
    $('.pop-body').fadeOut();
    $('.colorlight, .colordark').show();
    }
  });


  $('.get-popup1').click(function(e) {
    $('#cool-popup').fadeIn();
  });

  $('.get-popup2').click(function(e) {
    $('#warm-popup').fadeIn();
  });

  $('.get-popup3').click(function(e) {
    $('#neutral-popup').fadeIn();
  });

  $('.closePop').click(function(e) {
    $('.pop-body').fadeOut();
  });


});

function progress(){	
  var progressVal = $('.question-Box:visible').attr('data-wdth');
  $(".prgress-1").css("width", progressVal + "%");
  if ( progressVal == 84){
    progressbar()
  }
}

var id = 0;
function progressbar() {
  var elem = document.getElementById("analyzeProgress");  
  var width = 1;
  id = setInterval(frame, 60);
  function frame() {
    if (width >= 100) {
      clearInterval(id);
      window.setTimeout(function(){
        $('.step-12').hide();
        $('.step-13').fadeIn(); 
      }, 100);
    } else {
      width++;
      elem.style.width = width + '%';
    }

    $('.progVal').html(width + "%");

  }
}


// $('.submit-btn').click(function () {
  
//   var myData = $(".full_length_box").serializeArray();
//      	console.log(myData);
  
//   var emailaddress = $('.full_length_box .mail-field').val();
 
//   if( validateEmail(emailaddress)) {
//     var myData = $(".full_length_box").serializeArray();
// //   	console.log(myData);
//     var custom_field = {};
//     for(i=0 ; i< 11 ; i++){
//       custom_field['custom_field_'+(i+1)] = myData[i]['name'] + ' => ' + myData[i]['value'];
//     }
    
//     var quizdata = {
//       "contact": {
//         "email": myData[11]['value'],
//         custom_field,
//         "remove_from_dnm": false
//       }
//     };
//     $.ajax({
//       type: "POST",
//       crossDomain: true, 
//       dataType: 'jsonp',
//       url: "https://apps.fieracosmetics.com/maropost/maropost.php",
//       data: {data: quizdata},
//       success: function(result) {
//         console.log(quizdata);
//       },
//       headers: {
//         'Access-Control-Allow-Origin': '*'
//       }
//     });    
//   }

// });


function validateEmail($email) {
  var emailReg = /^([\w-\.]+@([\w-]+\.)+[\w-]{2,4})?$/;
  return emailReg.test( $email );
}